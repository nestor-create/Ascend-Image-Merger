<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ascend Image Merger</title>

<style>
body{
  font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;
  margin:0;
  background:#fafafa;
  color:#111;
}

header{
  padding:16px 24px;
  background:#ffffff;
  border-bottom:1px solid #e7e7e7;
  position:sticky;
  top:0;
  z-index:10;
}

.header-container{
  display:flex;
  align-items:center;
  gap:14px;
}

.logo{
  height:36px;
  width:auto;
  border-radius:8px;
}

h1{margin:0;font-size:18px;}
.sub{margin-top:6px;font-size:13px;color:#555;}

.wrap{
  max-width:1100px;
  margin:16px auto;
  padding:0 16px 24px;
  display:grid;
  grid-template-columns:360px 1fr;
  gap:16px;
}
@media(max-width:980px){.wrap{grid-template-columns:1fr}}

.card{
  background:#fff;
  border:1px solid #e7e7e7;
  border-radius:12px;
  box-shadow:0 2px 10px rgba(0,0,0,.04);
  overflow:hidden;
}
.card h2{
  margin:0;
  font-size:14px;
  padding:12px;
  border-bottom:1px solid #eee;
  background:#fcfcfc;
}
.content{padding:12px;}

.drop{
  border:2px dashed #cfcfcf;
  border-radius:12px;
  padding:14px;
  background:#fbfbfb;
  text-align:center;
  min-height:120px;
  display:flex;
  flex-direction:column;
  gap:8px;
  align-items:center;
  justify-content:center;
}
.drop.dragover{border-color:#111;background:#f3f3f3}

button{
  border:1px solid #ddd;
  background:#fff;
  padding:9px 10px;
  border-radius:10px;
  cursor:pointer;
  font-weight:700;
  font-size:13px;
}
button.primary{background:#111;color:#fff;border-color:#111}
button:disabled{opacity:.5;cursor:not-allowed}

label{display:block;font-size:12px;color:#444;margin-top:10px;}
input[type="number"], input[type="text"]{
  width:100%;
  box-sizing:border-box;
  padding:9px 10px;
  border-radius:10px;
  border:1px solid #ddd;
  font-size:13px;
  margin-top:6px;
}

.list{
  display:flex;
  flex-direction:column;
  gap:8px;
  max-height:280px;
  overflow:auto;
  margin-top:8px;
}

.item{
  display:grid;
  grid-template-columns:56px 1fr auto;
  gap:10px;
  align-items:center;
  border:1px solid #eee;
  border-radius:12px;
  padding:8px;
}

.thumb{
  width:56px;
  height:56px;
  border-radius:10px;
  object-fit:cover;
  background:#f0f0f0;
  border:1px solid #eee;
}

.meta{font-size:12px;color:#555;}
.meta b{display:block;color:#111;font-size:13px;margin-bottom:2px;}

.actions{display:flex;gap:6px;}
.actions button{padding:6px 8px;border-radius:10px;font-size:12px;}

.status{font-size:12px;color:#555;}
.canvasWrap{
  margin-top:10px;
  border:1px solid #eee;
  border-radius:12px;
  overflow:auto;
  background:#fff;
  max-height:72vh;
}
canvas{display:block;max-width:100%;height:auto}
.note{font-size:12px;color:#666;margin-top:10px;}
.kbd{
  font-family:ui-monospace,Menlo,Consolas,monospace;
  border:1px solid #ddd;
  border-bottom-width:2px;
  border-radius:8px;
  padding:2px 6px;
  background:#fff;
  font-size:12px;
}
</style>
</head>

<body>

<header>
  <div class="header-container">
    <img src="ascend-logo.png" alt="Ascend Logo" class="logo">
    <div>
      <h1>Ascend Image Merger</h1>
      <div class="sub">
        Paste with <span class="kbd">Ctrl</span>+<span class="kbd">V</span>, stack vertically in HD.
      </div>
    </div>
  </div>
</header>

<main class="wrap">

<section class="card">
<h2>Input</h2>
<div class="content">

<div id="drop" class="drop" tabindex="0">
<strong>Paste or drop images here</strong>
<small>Ctrl+V • or drag files • or Add Images</small>
<br>
<button id="addBtn" class="primary">Add Images</button>
<button id="clearBtn" disabled>Clear</button>
<input id="fileInput" type="file" accept="image/*" multiple hidden>
</div>

<label>Images</label>
<div id="list" class="list"></div>

<label>Gap (px)</label>
<input id="gap" type="number" min="0" value="0">

<label>Background</label>
<input id="bg" type="text" value="#ffffff">

<label>Output scale (HD)</label>
<input id="scale" type="number" min="1" value="1">

<br>
<button id="mergeBtn" class="primary" disabled>Merge</button>
<button id="copyBtn" disabled>Copy</button>
<button id="openBtn" disabled>Open</button>

<div id="warn" class="note"></div>

</div>
</section>

<section class="card">
<h2>Preview</h2>
<div class="content">
<div id="status" class="status">Add images to start.</div>
<div class="canvasWrap">
<canvas id="canvas"></canvas>
</div>
</div>
</section>

</main>

<script>
const drop=document.getElementById('drop');
const fileInput=document.getElementById('fileInput');
const addBtn=document.getElementById('addBtn');
const clearBtn=document.getElementById('clearBtn');
const listEl=document.getElementById('list');
const gapEl=document.getElementById('gap');
const bgEl=document.getElementById('bg');
const scaleEl=document.getElementById('scale');
const mergeBtn=document.getElementById('mergeBtn');
const copyBtn=document.getElementById('copyBtn');
const openBtn=document.getElementById('openBtn');
const statusEl=document.getElementById('status');
const warnEl=document.getElementById('warn');
const canvas=document.getElementById('canvas');
const ctx=canvas.getContext('2d');

let items=[];
let lastBlobUrl=null;

function updateUI(){
listEl.innerHTML='';
items.forEach((it,idx)=>{
const row=document.createElement('div');
row.className='item';
row.innerHTML=`
<img src="${it.url}" class="thumb">
<div class="meta"><b>${it.name}</b>${it.w} × ${it.h}px</div>
<div class="actions">
<button ${idx===0?'disabled':''} onclick="move(${idx},${idx-1})">↑</button>
<button ${idx===items.length-1?'disabled':''} onclick="move(${idx},${idx+1})">↓</button>
<button onclick="removeAt(${idx})">✕</button>
</div>`;
listEl.appendChild(row);
});
clearBtn.disabled=!items.length;
mergeBtn.disabled=items.length<2;
statusEl.textContent=items.length?items.length+" image(s) loaded.":"Add images to start.";
}

function move(from,to){
const a=items.splice(from,1)[0];
items.splice(to,0,a);
updateUI();
}

function removeAt(i){
URL.revokeObjectURL(items[i].url);
items.splice(i,1);
updateUI();
}

function loadFile(file){
return new Promise((resolve)=>{
const url=URL.createObjectURL(file);
const img=new Image();
img.onload=()=>resolve({name:file.name||"image",img,w:img.naturalWidth,h:img.naturalHeight,url});
img.src=url;
});
}

async function addFiles(files){
const arr=Array.from(files).filter(f=>f.type.startsWith("image/"));
const loaded=await Promise.all(arr.map(loadFile));
items.push(...loaded);
updateUI();
}

window.addEventListener('paste',async(e)=>{
const files=[];
for(const item of e.clipboardData.items){
if(item.kind==='file'){
const f=item.getAsFile();
if(f.type.startsWith("image/")) files.push(f);
}
}
if(files.length){e.preventDefault();await addFiles(files);}
});

drop.addEventListener('dragover',(e)=>{e.preventDefault();drop.classList.add('dragover');});
drop.addEventListener('dragleave',()=>drop.classList.remove('dragover'));
drop.addEventListener('drop',async(e)=>{
e.preventDefault();
drop.classList.remove('dragover');
if(e.dataTransfer.files.length) await addFiles(e.dataTransfer.files);
});

addBtn.onclick=()=>fileInput.click();
fileInput.onchange=()=>addFiles(fileInput.files);
clearBtn.onclick=()=>{items=[];canvas.width=canvas.height=0;updateUI();};

mergeBtn.onclick=async()=>{
const gap=parseInt(gapEl.value)||0;
const scale=parseInt(scaleEl.value)||1;
const bg=bgEl.value;

const outW=Math.max(...items.map(i=>i.w));
const outH=items.reduce((s,i)=>s+i.h,0)+gap*(items.length-1);

canvas.width=outW*scale;
canvas.height=outH*scale;

ctx.fillStyle=bg;
ctx.fillRect(0,0,canvas.width,canvas.height);
ctx.scale(scale,scale);

let y=0;
for(const it of items){
const x=(outW-it.w)/2;
ctx.drawImage(it.img,x,y);
y+=it.h+gap;
}
ctx.setTransform(1,0,0,1,0,0);

const blob=await new Promise(res=>canvas.toBlob(res,'image/png'));
lastBlobUrl=URL.createObjectURL(blob);
openBtn.disabled=false;
copyBtn.disabled=false;
statusEl.textContent="Merged: "+canvas.width+" × "+canvas.height+"px";
};

copyBtn.onclick=async()=>{
const blob=await new Promise(res=>canvas.toBlob(res,'image/png'));
await navigator.clipboard.write([new ClipboardItem({'image/png':blob})]);
warnEl.textContent="Copied!";
setTimeout(()=>warnEl.textContent="",1500);
};

openBtn.onclick=()=>window.open(lastBlobUrl,'_blank');

updateUI();
</script>

</body>
</html>